<HTML>
<HEAD>
<TITLE>Χρησιμοποιώντας τις resload_Protect#?</TITLE>
<meta name="DC.Language" content="gr">
<meta http-equiv="content-language" content="gr">
<meta http-equiv="content-type" content="text/html; charset=iso-8859-7">
<!-- $Id: prot.html 1.3 2015/04/19 21:08:08 wepl Exp wepl $ -->
</HEAD>
<BODY>
<h3>Χρησιμοποιώντας τις resload_Protect#?</h3>
<h4>Θεωρία</h4>
Υπάρχουν διάφορες περιπτώσεις στις οποίες ίσως είναι πολύ χρήσιμο να πληροφορείστε
όταν το εγκατεστημένο πρόγραμμα έχει προσβάσεις σε συγκεκριμένες περιοχές μνήμης.
Με τις συναρτήσεις <a href="../autodoc.html">resload_Protect#?</a>
είναι δυνατόν να προστατευτούν μερικές περιοχές μνήμης από ανάγνωση και/ή εγγραφή από
τον επεξεργαστή. Προστασία σημαίνει ότι κάθε πρόσβαση σε τέτοια προστατευόμενη περιοχή
θα δημιουργήσει μια εξαίρεση Access Fault που θα έχει σας αποτέλεσμα έναν
αντίστοιχο επιλογέα από το WHDLoad. Αν ορίσετε μια περιοχή μνήμης ως προστατευόμενη
χρησιμοποιώντας τη συνάρτηση <a href="../autodoc.html">resload_Protect#?</a>
το WHDLoad θα τροποποιήσει τις περιγραφές των επηρεαζόμενων σελίδων στο δέντρο μετάφρασης του MMU.
Τώρα κάθε πρόσβαση στη προστατευόμενη σελίδα από το CPU θα δημιουργήσει μια εξαίρεση Access Fault.
Ο χειριστής εξαιρέσεων μέσα στο WHDLoad θα επιβεβαιώσει το λόγο για την
εξαίρεση. Αν ο λόγος ήταν μια πρόσβαση σε προστατευμένη <a href="mmu.html">σελίδα</a> αλλά η πρόσβαση
δεν ταιριάζει με την προστατευόμενη περιοχή η πρόσβαση θα εξομοιωθεί, και θα
συνεχιστεί η κανονική εκτέλεση του προγράμματος. Διαφορετικά το WHDLoad θα τερματιστεί με έναν κατάλληλο
επιλογέα. Αν η πρόσβαση ήταν μια πρόσβαση στη ροή εντολών (π.χ. η CPU
προσπαθεί να φορτώσει κώδικα) θα εξομοιωθεί πάντα, ή με άλλα λόγια οι συναρτήσεις <a
href="../autodoc.html">resload_Protect#?</a> επηρεάζουν μόνο ανάγνωση και εγγραφή δεδομένων. 
Το γεγονός ότι κάθε πρόσβαση σε προστατευόμενη σελίδα
(το μέγεθος σελίδας προς το παρόν είναι 4096 bytes) θα δημιουργήσει ένα σφάλμα πρόσβασης, 
ακόμα και αν η προστατευόμενη περιοχή έχει μήκος μόνο 1 byte, έχει ως αποτέλεσμα μια 
σημαντική καθυστέρηση της ταχύτητας εκτέλεσης του προγράμματος. Ειδικά αν κομμάτια του κώδικα βρίσκονται
στην ίδια σελίδα. Αν το πρόγραμμα εξαρτάται από την ταχύτητα εκτέλεσης, είναι πιθανές
οι διαφορές στην εκτέλεση. Οπότε είναι πιθανόν μερικά προγράμματα να μην λειτουργήσουν
με το χαρακτηριστικό προστασίας resload_Protect.
<h4>Παράδειγμα: checksums πάνω σε κώδικα</h4>
Αν εγκαταστήσετε ένα παιχνίδι χρησιμοποιώντας το WHDLoad πρέπει να διορθώσετε τις αρχικές
ρουτίνες του loader στο παιχνίδι με τέτοιο τρόπο ώστε αυτές να χρησιμοποιούν το WHDLoad για να φορτώσουν
τα δεδομένα του παιχνιδιού. Μερικά παιχνίδια πραγματοποιούν checksums πάνω σε συγκεκριμένες περιοχές κώδικα
για να ανακαλύψουν αν ο αυθεντικός κώδικας έχει αλλαχθεί. Αυτές οι ρουτίνες ελέγχου μπορεί μερικές φορές
να είναι δυσεύρετες. Αλλά χρησιμοποιώντας τις συναρτήσεις <a
href="../autodoc.html">resload_Protect#?</a> στο WHDLoad
θα είναι εύκολο. Το μόνο που πρέπει να κάνετε είναι να προστατέψετε τα bytes
που αλλάξατε στο κώδικα του παιχνιδιού από ανάγνωση. Τώρα κάθε ρουτίνα που προσπαθεί να κάνει
ένα checksum και να διαβάσει το διορθωμένο κώδικά σας θα προκαλέσει ένα σφάλμα πρόσβασης. Και θα ξέρετε
που βρίσκεται η ρουτίνα.
<h4>Περιορισμοί</h4>
Δεν πρέπει να προστατέψετε τη σελίδα μνήμης στην οποία δείχνει το SSP. Αν το κάνετε
και παρουσιαστεί μια εξαίρεση, θα έχει ως αποτέλεσμα ένα Double Bus Fault διότι η CPU
δεν θα μπορεί να γράψει το πλαίσιο στοίβας (stackframe) εξαιρέσεων. Μετά από ένα Double Bus Fault
μόνο μια επανεκκίνηση μπορεί να συνεχίσει την εκτέλεση. Το WHDLoad ελέγχει για
σύγκρουση των προστατευόμενων περιοχών με το SSP και τερματίζεται αν υπάρξει. Αλλά αυτό
δεν θα βοηθήσει αν το SSP αλλάξει μετά.

<p>Για περισσότερους περιορισμούς και πληροφορίες παρακαλώ ελέγξτε τις καταχωρήσεις Autodoc για τα
διάφορα χαρακτηριστικά του resload_Protect:
<ul>
<li><a href="../autodoc.html#resload_ProtectRead">resload_ProtectRead</a>
<li><a href="../autodoc.html#resload_ProtectReadWrite">resload_ProtectReadWrite</a>
<li><a href="../autodoc.html#resload_ProtectRemove">resload_ProtectRemove</a>
<li><a href="../autodoc.html#resload_ProtectSMC">resload_ProtectSMC</a>
<li><a href="../autodoc.html#resload_ProtectWrite">resload_ProtectWrite</a>
</ul>
</BODY>
</HTML>
